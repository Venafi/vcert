config:
  connection:
    platform: tpp
    url: https://my.tpp.instance.company.com
    trustBundle: 'path/to/TrustBundle.pem' # requierd for cert based authentication
    credentials:
      clientId: vcert-cli
      p12Task: apiP12
      scope: certificate:manage
certificateTasks:
  - name: apiP12  # Ref to pkcs12 authentication!
    renewBefore: 5%
    request:
      csr: local
      subject: 
        # An AD computer account can use a certificate to get Access/Refresh tokens from TPP
        # - Use either HOSTNAME$ (the sAMAccountName) or HOSTNAME@example.com in either the 
        #   CN or UPN (depending on your TPP config). AD doesn't set UPNs on computer accounts
        #   by default, so either add it to the computer account, or use the sAMAccountName.
        # - Computer accounts can't be granted access to API applications by default. However, 
        #   a group can be setup (or leverage "Domain Computers" for all computer accounts)
        commonName: 'certAuthUser' # Example of using the sAMAccountName
      sanUpn:
        - '{{ Hostname | ToLower -}}@lab.securafi.net'
      zone: Certificates\ClientAuth # Grant permissions in this folder to "Domain Computers"
    installations:
      - format: PKCS12
        file: '{{ Env "HOME" }}/.vcert/vcertAuth.p12'
         p12Password: <MySuperSecurePassw0rd1!-ncu39rhw9suf>  

